# Ralph Progress Log
Started: Thu 13 Feb 2026

## Codebase Patterns
- Bun shell template `$\`git ...\`` returns ShellOutput; use `.quiet().nothrow().cwd().text()` pattern for git subprocess calls
- `StartupTrace.measure()` wraps async fns with begin/end for nested phase tracking
- `iife()` utility is used for inline async blocks returning typed results
- Sequential git subprocess calls that are independent can be parallelized with `Promise.all()`
- `.git/opencode` file caches root commit ID to avoid expensive `git rev-list` on every startup
- Project detection uses `Filesystem.up()` iterator to find `.git` directories
---

## 2026-02-13 - US-001 through US-009
- Previously implemented in prior iterations (commits 8e02c38dd through 430c6b582)
- Includes: startup-trace infrastructure, terminal bg detection optimization, Log.init optimization,
  resolveNetworkOptions decoupling, global/index.ts deblocking, remote config timeout/caching,
  plugin parallel loading, installDependencies deferral, config pipeline parallelization
---

## 2026-02-13 - US-010
- What was implemented: Parallelized `git rev-parse --show-toplevel` and `git rev-parse --git-common-dir` using Promise.all()
- Files changed: `packages/opencode/src/project/project.ts`
- **Learnings for future iterations:**
  - The two git rev-parse commands are independent read operations that can safely run in parallel
  - `git rev-list --max-parents=0 --all` cache logic was already effective â€” only runs on first encounter per repo, result cached in `.git/opencode`
  - Removed the `if (!worktree)` fallback branch by handling the case inline (commonDirResult check)
  - Session-level caching of rev-parse results was considered but deemed unnecessary since project detection itself is cached per directory in Instance.provide()
---

